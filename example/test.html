<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>SelfNetFS Test</title>
  <script src="./selfnetfs.js"></script>
</head>
<body>
  <script>
    'use strict';

    function tenc(text) {
      return new TextEncoder().encode(text);
    }

    function tdec(data) {
      return new TextDecoder().decode(data);
    }

    async function main() {
      const snfs = new SNFSMemory(uuidgen, new SNFSPasswordModuleNull());
      await snfs.bootstrap('admin', 'password');
      const ses = await snfs.login({ name: 'admin', password: 'password' });
      const fs = await ses.fs();

      await fs.writefile('/test1', tenc('1234567890'));
      await fs.writefile('/test2', tenc('abcdefghij'));
      await fs.move('/test1', '/test2');
      console.log(fs);
      await fs.writefile('/test1', tenc('1234567890'));
      await fs.writefile('/test2', tenc('abcdefghij'));
      await fs.unlink('/test2');
      await fs.move('/test1', '/test2');
      console.log(fs);
    }

    main().then(() => {
      console.log('Done.');
    }).catch(err => {
      console.error(err);
    });
  </script>
</body>
</html>
